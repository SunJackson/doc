# 摘要

时空预测有很多应用，比如天气预测和城市规划。尤其是，因为交通相关数据集的增长及其在实际应用中的影响，交通预测在数据挖掘研究领域越来越受到关注。
比如，准确的出租车需求预测可以版主出租车公司预先分配出租车以满足换乘需求。
交通流量预测的关键挑战在于如何模拟复杂的时间以及空间依赖性。
在这篇论文中，我们做了两个从未被先前研究所考虑的重要指标：
（1）位置之间的空间依赖是动态的;
（2）时间依赖性遵循强烈的周期性，但对于其动态的时间变化并不是严格的周期性。
基于上面两个方面的观察，我们提出了时空动态网络（STDN）框架。
在这个框架中，我们提出了一种流量门控机制，通过交通流来学习位置之间的动态相似性。
周期性改变的注意机制旨在处理长期周期性依赖和周期性时间转换。
此外，我们通过使用图形卷积结构扩展了我们的框架，从基于区域的交通预测到道路交叉口的交通预测。
我们对几个大型真实交通数据集进行了大量实验，并展示了我们采用最先进方法的有效性。

# 关键字

时空动态 深度学习 交通预测

# 1 简介

时空预测普遍存在与现实生活中，从天气预测，到下一个位置预测，到交通预测。特别的，交通预测越来越受到关注，越来越多的交通数据集，例如出租车接送乘客的数据，以及从摄像头获取到的交通状况。
同时，一个准确的交通预测框架对很多实际应用必不可少。
例如，出租车需求预测可以帮助出租车公司预先分配出租车;交通预测可以帮助运输部门更好地管理和控制交通，以缓解交通拥堵。

在典型的交通流量预测设置中，给定历史交通数据（例如，上个月每小时的区域或道路交叉路口的交通量），我们的目标是预测下一个时段的流量。
几十年来，一些研究调查了交通规则。在时间序列研究社区中，自回归整合移动平均（arima）和卡尔曼滤波已广泛应用于交通预测问题。
虽然这些方法研究了每个单独位置的交通时间序列，但最近的研究进一步利用了空间信息（例如，为附近位置增加了模型相似性的调整）和外部环境信息（例如，添加场地信息，天气状况和当地活动的功能）。然而，那些研究仍然基于传统的时间序列模型或者机器学习模型并且不能很好地捕捉复杂的非线性时空依赖性。

最近，深度学习在许多具有挑战性的领域具展现出了很好的学习能力和代表能力。
例如在计算机视频，自然语言处理，语音识别和推荐算法领域。
这一成功激发了几种将深度学习技术应用于交通预测问题。
例如，最近的研究将城市交通视为热图图像，其中每个像素值代表相应区域的交通。
在这些研究中，循环神经网络（CNN）用于模拟非线性空间依赖性。
为了模拟非线性时间依赖性，研究者建议使用基于递归神经网络（RNN）的框架。
姚等人，进一步提出可一种通过整合CNN和长短期记忆（LSTM）来共同模拟空间和时间依赖关系的方法。

使用深度学习技术进行交通预测的现有方法有两个主要局限。第一，位置之间的空间依赖性仅依赖于历史交通的相似性和模型学习静态空间的依赖性。
然而，位置之间的依赖关系可能会随着时间而改变。
例如，在早上，居民区和商业中心之间的依赖性很强;而在深夜，工作地点和餐厅之间的依赖性则很强。
交通流量数据是描述这种动态关系的有用信息源。

另一个限制是许多现有的研究忽视了长期周期性依赖的转变。交通数据显示出强烈的每周周期性，并且对先前周期时间帧的依赖性可用于预测。然而，其中一个难点是交通数据并不是严格定期的。
例如，工作日的高峰时段通常在下午晚些时候，但是不同日期的下午4:30至下午6:00可能会有所不同。
虽然以前的研究考虑周期性交通数据，但他们无法在周期性中依赖顺序依赖和时间转移。

为了解决上述挑战，我们提出了一种新颖的深度学习架构，用于交通预测的时空动态网络（STDN）。
STDN基于时空神经网络，分别通过CNN和LSTM处理空间和时间信息。提出了一种流量门控CNN，通过使用交通流信息对位置之间的动态相似性进行建模来处理空间依赖性。提出一种周期性改变的注意机制来学习长期的依赖性。提出通过注意机制捕获长期定期信息和交通序列中的时间变化。
此外，我们使用LSTM以分层的方式处理顺序依赖。
最后，我们的方法可以很容易地扩展到图像卷积神经网络，并可以预测道路交叉口的交通量。

我们在大型现实公共数据集上评估我们提出的方法，包括纽约市的出租车数据（NYC），NYC的自行车共享数据，以及中国济南的道路相机数据。
通过与现有技术方法的全面比较证明了我们提出的方法的有效性。

综上，我们的贡献如下：

- 我们提出了一种流动门控机制来明确地模拟动态空间相似性。
- 我们通过同时获取长期周期信息和时间偏移，提出了周期性转移的注意机制。
- 我们将模型扩展到道路交叉口交通预测，它使用图形卷积结构来捕获空间依赖性。
- 我们对几个真实世界的交通数据集进行了实验。结果表明，我们的模型始终优于其他最先进的方法。


本文其余部分安排如下。相关工作在第2节中讨论。我们描述了一些符号和我们的问题部分3。所提出的方法在第4节中介绍。我们将在第5节详细讨论实验结果。最后，我们在第6节中总结了这篇论文。


# 2 相关工作



